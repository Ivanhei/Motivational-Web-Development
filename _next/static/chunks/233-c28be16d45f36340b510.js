(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[233],{4288:function(e,n,t){"use strict";t.d(n,{Z:function(){return c}});var r=t(5893),s=t(7839),i=t(7922),o=(t(6690),t(5913)),a=t.n(o);function c(e){var n=e.signInSuccessUrl,t=(0,s.hI)(n||""),o={signInFlow:"popup",signInSuccessUrl:n?t:void 0,signInOptions:[i.Z.auth.EmailAuthProvider.PROVIDER_ID]};return(0,r.jsx)(a(),{uiConfig:o,firebaseAuth:i.Z.auth()})}},233:function(e,n,t){"use strict";t.d(n,{Z:function(){return fe}});var r,s=t(5893),i=t(7329),o=t(4699),a=t(1664),c=t(9008),u=t(3006),l=t(7294),d=t(4288),f=t(6716),p=t(2401),h=t(1751),g=t(4975),v=t(7839),m={en:{hint_button:"Hint",answer_button:"Answer",instruction_spelling_audio:"Spell the word you heard.",instruction_mc_audio:"Select the word you heard.",instruction_spelling_translate:'Write "[]" in English.',instruction_mc_translate:"Translate the underlined word.",instruction_speech:'Read the word "[]".',recording_button:"Press to Speak"},jp:{hint_button:"\u30d2\u30f3\u30c8",answer_button:"\u6b21\u3078",instruction_spelling_audio:"\u805e\u3053\u3048\u305f\u5358\u8a9e\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044",instruction_mc_audio:"\u805e\u3053\u3048\u305f\u5358\u8a9e\u3092\u9078\u3093\u3067\u304f\u3060\u3055\u3044",instruction_spelling_translate:"\u300c[]\u300d\u3092\u82f1\u8a9e\u3067\u66f8\u3044\u3066\u304f\u3060\u3055\u3044",instruction_mc_translate:"\u4e0b\u7dda\u4ed8\u304d\u6587\u5b57\u3092\u7ffb\u8a33\u3057\u3066\u304f\u3060\u3055\u3044",instruction_speech:"\u300c[]\u300d\u3092\u82f1\u8a9e\u3067\u8aad\u307f\u4e0a\u3052\u3066\u304f\u3060\u3055\u3044",recording_button:"\u62bc\u3057\u3066\u8a71\u3059"}};function x(e){var n=e.audio_url,t=(0,l.useMemo)((function(){return new Audio(n)}),[n]),r=(0,l.useCallback)((function(){t.play().catch((function(e){if("NotAllowedError"!==e.name)throw e;console.log("This system does not allow audio to be auto-played.")}))}),[t]);return(0,l.useEffect)((function(){r()}),[r]),(0,s.jsx)("div",{className:"question_area audio",children:n?(0,s.jsx)("div",{className:"playbutton",onClick:function(e){return r()},children:(0,s.jsx)(u.o1,{})}):(0,s.jsx)("h3",{style:{color:"red"},children:"Error: Audio not found. "})})}!function(e){e[e.NOT_ANSWERED_YET=-1]="NOT_ANSWERED_YET",e[e.ANSWER_INCORRECT=0]="ANSWER_INCORRECT",e[e.ANSWER_CORRECT=1]="ANSWER_CORRECT"}(r||(r={}));var w=t(6156),j=t(850),_=t.n(j);function b(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?b(Object(t),!0).forEach((function(n){(0,w.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function E(e){var n=(0,l.useRef)(),t=(0,l.useRef)(),r=(0,l.useState)(1),i=r[0],o=r[1];return(0,l.useEffect)((function(){function e(){o((function(e){var r=e*n.current.clientWidth/t.current.clientWidth;return r<1?r:1}))}return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),(0,s.jsx)("button",N(N({},e),{},{children:(0,s.jsx)("span",{className:_().outterSpan,ref:n,children:(0,s.jsx)("span",{className:_().innerSpan,ref:t,style:{fontSize:i+"em"},children:e.children})})}))}function S(e){var n=e.options,t=e.selected,i=e.onChange,o=e.answerState;return(0,s.jsx)("div",{className:"answer_area options",children:n.map((function(e,n){return(0,s.jsx)(E,{disabled:o!==r.NOT_ANSWERED_YET&&t!==e,className:"option "+(t===e?o===r.ANSWER_CORRECT?"correct":o===r.ANSWER_INCORRECT?"incorrect":"selected":""),onClick:function(n){return i(e)},children:e},n)}))})}function y(e,n){return e===n}function C(e){var n=e.lang;return(0,s.jsx)("div",{className:"instruction",children:m[n].instruction_mc_audio})}var R={UI:function(e){var n=e.lang,t=e.challenge,r=e.currentAnswer,i=e.onAnswerChange,o=e.answerState;return(0,s.jsxs)("div",{className:"session quizStyles question_container",children:[(0,s.jsx)(C,{lang:n}),(0,s.jsx)(x,{audio_url:t.audio_url}),(0,s.jsx)(S,{options:t.options,selected:r,onChange:i,answerState:o})]})},checkAnswer:y};function O(e){var n=e.question,t=e.primary,r=e.secondary,i=e.image_url,o=(0,l.useMemo)((function(){return t?(0,s.jsx)(v.ly,{sentence:t,inside:n}):(0,s.jsx)(s.Fragment,{})}),[t,n]),a=(0,l.useMemo)((function(){return r?(0,s.jsx)(v.ly,{sentence:r,inside:"\u3000\u3000\u3000"}):(0,s.jsx)(s.Fragment,{})}),[r]);return(0,s.jsxs)("div",{className:"question_area ".concat(r?"multilingual":""," ").concat(i?"image_container":""),children:[t?(0,s.jsx)("div",{className:"primary",children:o}):null,r?(0,s.jsx)("div",{className:"secondary",children:a}):null,i?(0,s.jsx)("img",{src:i,alt:n}):null]})}function A(e){var n=e.lang;return(0,s.jsx)("div",{className:"instruction",children:m[n].instruction_mc_translate})}var T={UI:function(e){var n,t,r=e.lang,i=e.challenge,o=e.currentAnswer,a=e.onAnswerChange,c=e.answerState;return(0,s.jsxs)("div",{className:"session quizStyles question_container",children:[(0,s.jsx)(A,{lang:r}),(0,s.jsx)(O,{question:i.question,primary:null===(n=i.sentence)||void 0===n?void 0:n.japanese,secondary:null===(t=i.sentence)||void 0===t?void 0:t.english,image_url:i.image_url}),(0,s.jsx)(S,{options:i.options,selected:o,onChange:a,answerState:c})]})},checkAnswer:y};function P(e){var n=e.value,t=e.onChange,i=e.answerState;return(0,s.jsx)("div",{className:"answer_area input_container",children:(0,s.jsx)("input",{autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",onChange:function(e){return t(e.target.value)},className:"input "+(n.length>0?i===r.ANSWER_CORRECT?"correct":i===r.ANSWER_INCORRECT?"incorrect":"answered":""),value:n})})}function k(e,n){return e.toLowerCase()===n.toLowerCase()}function q(e){var n=e.lang;return(0,s.jsx)("div",{className:"instruction",children:m[n].instruction_spelling_audio})}var W={UI:function(e){var n=e.lang,t=e.challenge,r=e.currentAnswer,i=e.onAnswerChange,o=e.answerState;return(0,s.jsxs)("div",{className:"session quizStyles question_container",children:[(0,s.jsx)(q,{lang:n}),(0,s.jsx)(x,{audio_url:t.audio_url}),(0,s.jsx)(P,{value:r,onChange:i,answerState:o})]})},checkAnswer:k};function I(e){var n=e.lang,t=e.question;return(0,s.jsx)("div",{className:"instruction",children:(0,v.A2)(m[n].instruction_spelling_translate,t)})}var Z={UI:function(e){var n,t,r=e.lang,i=e.challenge,o=e.currentAnswer,a=e.onAnswerChange,c=e.answerState;return(0,s.jsxs)("div",{className:"session quizStyles question_container",children:[(0,s.jsx)(I,{lang:r,question:i.question}),(0,s.jsx)(O,{question:i.question,primary:null===(n=i.sentence)||void 0===n?void 0:n.japanese,secondary:null===(t=i.sentence)||void 0===t?void 0:t.english,image_url:i.image_url}),(0,s.jsx)(P,{value:o,onChange:a,answerState:c})]})},checkAnswer:k};function z(e){var n=e.word,t=e.audio_url,r=e.listeningToSpeech,i=e.onPlayingStateChange,o=(0,l.useState)(!1),a=o[0],c=o[1],d=(0,l.useMemo)((function(){var e=new Audio(t);return e.addEventListener("ended",(function(e){c(!1)})),e}),[t]),f=(0,l.useCallback)((function(){d.play().catch((function(e){if("NotAllowedError"!==e.name)throw e;console.log("This system does not allow audio to be auto-played.")})).then((function(){c(!0)}))}),[d]);return(0,l.useEffect)((function(){i(a)}),[a,i]),(0,l.useEffect)((function(){r&&(d.pause(),d.currentTime=0)}),[r,d]),(0,s.jsx)("div",{className:"question_area speech",children:(0,s.jsxs)("div",{className:"primary",children:[(0,s.jsx)("div",{className:"playbutton",onClick:function(e){return f()},children:(0,s.jsx)(u.o1,{})}),(0,s.jsx)("span",{children:n})]})})}var U=t(2515);function D(e){var n=e.lang,t=e.answer,i=e.onChange,o=e.onNext,a=e.answerState,c=e.audioPlaying,d=e.onListeningStateChange,f=(0,U.x6)(),p=f.transcript,h=f.listening,g=f.resetTranscript,v=f.browserSupportsSpeechRecognition;(0,l.useEffect)((function(){p.split(/[^a-zA-Z0-9]+/).some((function(e){return(null===e||void 0===e?void 0:e.toLowerCase())===(null===t||void 0===t?void 0:t.toLowerCase())}))&&(g(),i(t))}),[t,v,i,o,g,p]),(0,l.useEffect)((function(){h||o()}),[o,h]);var x=(0,l.useCallback)((function(e){c||(h?U.ZP.stopListening():U.ZP.startListening({continuous:!1}))}),[c,h]);return(0,l.useEffect)((function(){d(h)}),[h,d]),(0,l.useEffect)((function(){c&&U.ZP.stopListening()}),[c]),(0,s.jsxs)("div",{className:"answer_area speech",children:[(0,s.jsxs)("button",{className:"\n          ".concat(h?"recording":""," \n          ").concat(a===r.ANSWER_CORRECT?"correct":"","\n          ").concat(a===r.ANSWER_INCORRECT?"incorrect":"","\n        "),onClick:x,disabled:!v||c,onFocus:function(e){e.target.blur()},children:[(0,s.jsx)(u.ZO,{width:"16",height:"24"}),(0,s.jsx)("span",{children:m[n].recording_button})]}),v?"":(0,s.jsx)("div",{style:{color:"red",marginTop:"1rem"},children:"This browser does not support speech. Please use Chrome or Safari with Internet coneection."})]})}function L(e){var n=e.lang,t=e.question,r=e.question_en;return(0,s.jsx)("div",{className:"instruction",children:"en"===n?(0,v.A2)(m.en.instruction_speech,r):(0,v.A2)(m.jp.instruction_speech,t)})}var M={UI:function(e){var n=e.lang,t=e.challenge,r=e.onAnswerChange,i=e.onNext,o=e.answerState,a=(0,l.useState)(!1),c=a[0],u=a[1],d=(0,l.useState)(!1),f=d[0],p=d[1],h=(0,l.useMemo)((function(){var e=t.answer.toLowerCase();return e.charAt(0).toUpperCase()+e.slice(1)}),[t.answer]);return(0,s.jsxs)("div",{className:"session quizStyles question_container",children:[(0,s.jsx)(L,{lang:n,question:t.question,question_en:t.answer}),(0,s.jsx)(z,{word:h,audio_url:t.audio_url,listeningToSpeech:f,onPlayingStateChange:u}),(0,s.jsx)(D,{lang:n,answer:t.answer,onNext:i,onChange:r,answerState:o,audioPlaying:c,onListeningStateChange:p})]})},checkAnswer:function(e,n){return e.toLowerCase()===n.toLowerCase()}};function Y(e,n){var t=e.challenge,i=(0,l.useState)(""),o=i[0],a=i[1],c=(0,l.useState)([]),u=(c[0],c[1],(0,l.useState)(r.NOT_ANSWERED_YET)),d=u[0],x=u[1],w=(0,l.useMemo)((function(){return"mc"===t.type?"translate"===(null===t||void 0===t?void 0:t.subtype)?T:R:"spelling"===t.type?"translate"===(null===t||void 0===t?void 0:t.subtype)?Z:W:M}),[null===t||void 0===t?void 0:t.subtype,t.type]),j=(0,v.hI)("/assets/sounds/correct_2.mp3"),_=(0,v.hI)("/assets/sounds/incorrect_2.mp3"),b=(0,v.Ye)(j,{volume:.1}),N=(0,v.Ye)(_,{volume:.1}),E=(0,l.useCallback)((function(){if(d===r.NOT_ANSWERED_YET){var n=w.checkAnswer(t.answer,o),s=n?r.ANSWER_CORRECT:r.ANSWER_INCORRECT;x(s),n?b.play():N.play(),n&&e.onCorrect()}}),[o,d,t.answer,b,N,w,e]),S=(0,l.useCallback)((function(){a(""),e.onNext(d===r.ANSWER_CORRECT),x(r.NOT_ANSWERED_YET)}),[d,e]),y=(0,l.useCallback)((function(){d===r.NOT_ANSWERED_YET?E():S()}),[d,E,S]),C=(0,l.useMemo)((function(){return new f.x}),[]);(0,l.useEffect)((function(){var e=(0,p.R)(document,"keyup").pipe((0,g.h)((function(e){return"Enter"===e.code}))),n=(0,h.T)(C,e).subscribe((function(e){0!==o.length&&y()}));return function(){n.unsubscribe()}}),[o,o.length,d,C,t.answer,E,S,y]);var O=(0,l.useMemo)((function(){return"en"}),[]),A=(0,l.useMemo)((function(){return m[O]}),[O]);return(0,s.jsxs)(l.Fragment,{children:[(0,s.jsx)(w.UI,{lang:O,currentAnswer:o,challenge:t,onNext:function(){return C.next()},onAnswerChange:function(e){d===r.NOT_ANSWERED_YET&&a(e)},answerState:d}),(0,s.jsxs)("div",{className:"footer quizStyles",children:[(0,s.jsxs)("div",{className:"session",children:[(0,s.jsx)("div",{className:"flex-grow"}),(0,s.jsx)("button",{disabled:0===o.length,onClick:function(e){return C.next()},children:A.answer_button})]}),(0,s.jsx)("div",{className:"advice ".concat(d===r.NOT_ANSWERED_YET?"":"shown"),children:(0,s.jsxs)("div",{className:"session",children:[(0,s.jsx)("div",{className:"flex-grow"}),(0,s.jsx)("button",{onClick:function(e){return C.next()},children:"Next Question"})]})})]})]})}function F(e){var n=(0,v.hI)("/assets/sounds/finish.wav"),t=(0,v.Ye)(n,{volume:.1});return(0,l.useEffect)((function(){t.play()}),[t]),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{children:"Congratulations!"}),(0,s.jsx)("div",{children:"You have completed the quiz!"})]})}function B(){return(0,s.jsx)("div",{className:"px-40 lg:px-60 xl:px-80 text-center",children:(0,s.jsx)("svg",{version:"1.1",id:"loader-1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 50 50",style:{enableBackground:"new 0 0 50 50",width:"100%",maxWidth:"72px",display:"inline-block"},children:(0,s.jsx)("path",{fill:"#000",d:"M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z",children:(0,s.jsx)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"rotate",from:"0 25 25",to:"360 25 25",dur:"0.6s",repeatCount:"indefinite"})})})})}var Q=t(8346),V=t(2334),H=t(5720),G=t(2303),$=t(2890),J=t(9127),K=t(7877),X=t(7922);t(6550);function ee(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ne(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ee(Object(t),!0).forEach((function(n){(0,w.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ee(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var te=X.Z.storage(),re=function(e){return ne(ne({},e.data()),{},{id:e.id,_ref:e.ref})},se=function(e){return e.audio?te.ref().child(e.audio).getDownloadURL().then((function(n){return ne(ne({},e),{},{audio_url:n})})).catch((function(n){return console.error("Error while getting Audio URL. ",n.code),e})):e},ie=function(e){return e.image?te.ref().child(e.image).getDownloadURL().then((function(n){return ne(ne({},e),{},{image_url:n})})).catch((function(n){return console.error("Error while getting Image URL. ",n.code),e})):e},oe=function(e){return function(n){return n.length>e?(0,v.$A)(n,e):n}},ae=((0,K.z)((function(e){return e.get()})),(0,J.U)(re)),ce=(0,K.z)((function(e){return Promise.all(e.map((function(e){return e.get()})))})),ue=(0,J.U)((function(e){return e.map(re)})),le=((0,J.U)((function(e){return e.docs.map(re)})),(0,K.z)((function(e){return Promise.all(e.map(se))}))),de=((0,K.z)(se),(0,K.z)((function(e){return Promise.all(e.map(ie))})));(0,K.z)(ie),t(3759);function fe(e){var n=e.topic,t=(0,l.useState)(0),r=t[0],p=t[1],h=(0,l.useState)(0),m=h[0],x=h[1],w=(0,l.useState)(0),j=w[0],_=w[1],b=(0,l.useState)([]),N=b[0],E=b[1],S=(0,l.useState)(!1),y=S[0],C=S[1],R=(0,l.useState)(!1),O=R[0],A=R[1],T=(0,l.useMemo)((function(){return new f.x}),[]),P=(0,l.useMemo)((function(){return new Q.t(1)}),[]);return(0,l.useEffect)((function(){var e=(0,v.Rt)().subscribe(P);return function(){e.unsubscribe()}}),[P]),(0,l.useEffect)((function(){y&&m===r&&T.next()}),[y,m,r,T]),(0,l.useEffect)((function(){var e=P.pipe((0,g.h)((function(e){return!!e}))).pipe((0,$.P)()).pipe((0,J.U)((function(e){return X.Z.firestore().collection("users").doc(e.uid).collection("finishedProblems").doc(n.id).get()}))).pipe((0,K.z)((function(e){return e}))).pipe(ae).pipe((0,J.U)((function(e){return e.problems}))),t=new f.x,r=t.pipe((0,J.U)((function(e){return e.problems}))),s=(0,V.a)([e,r]).pipe((0,J.U)((function(e){var n=(0,o.Z)(e,2),t=n[0],r=n[1];if(!t)return r;var s=oe(8)(r.filter((function(e){return!t.some((function(n){return n.isEqual(e)}))}))),a=oe(2)(t);return[].concat((0,i.Z)(s),(0,i.Z)(a))}))).pipe((0,J.U)((function(e){return(0,v.TV)(e)}))),a=s.pipe(ce).pipe(ue).pipe(le).pipe(de),c=new H.w0;return c.add(a.subscribe((function(e){E(e),C(!0)}))),c.add(s.subscribe((function(e){return p(e.length)}))),c.add(P.subscribe((function(e){return A(!e)}))),c.add((0,V.a)([t,s,P,T]).pipe((0,g.h)((function(e){var n=(0,o.Z)(e,4),t=(n[0],n[1],n[2]);n[3];return!!t}))).pipe((0,$.P)()).subscribe((function(e){var n,t=(0,o.Z)(e,4),r=t[0],s=t[1],a=t[2];t[3];X.Z.firestore().collection("users").doc(a.uid).collection("finishedProblems").doc(r.id).set({topic:r._ref,problems:(n=X.Z.firestore.FieldValue).arrayUnion.apply(n,(0,i.Z)(s))},{merge:!0})}))),c.add((0,G.Dp)(n.get()).pipe(ae).subscribe(t)),function(){c.unsubscribe()}}),[T,P,n]),(0,s.jsxs)("div",{className:"app-container",children:[(0,s.jsx)(c.default,{children:(0,s.jsx)("title",{children:"Quiz"})}),(0,s.jsxs)("nav",{className:"session progressNav",children:[(0,s.jsx)("div",{style:{opacity:y?1:0},className:"progressBar",children:(0,s.jsx)("div",{style:{width:100*j+"%"},className:"progress"})}),(0,s.jsx)("div",{className:"cross",children:(0,s.jsx)(a.default,{href:"/",children:(0,s.jsx)("a",{children:(0,s.jsx)(u.aM,{})})})})]}),O?(0,s.jsx)(d.Z,{}):y?m===N.length?(0,s.jsx)(F,{}):(0,s.jsx)(Y,{challenge:N[m],isLastQuestion:m===r-1,onCorrect:function(){_((function(e){return e+1/r}))},onNext:function(e){e?x((function(e){return e+1})):E((function(e){var n=e.splice(m,1);return[].concat((0,i.Z)(e),(0,i.Z)(n))}))}}):(0,s.jsx)(B,{})]})}},850:function(e){e.exports={outterSpan:"AutoSizeButton_outterSpan__2tvsU",innerSpan:"AutoSizeButton_innerSpan__2Gky6"}}}]);