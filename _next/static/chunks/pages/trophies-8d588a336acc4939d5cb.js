(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[471],{4699:function(e,n,r){"use strict";r.d(n,{Z:function(){return i}});var t=r(2961);function i(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var r=[],t=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done)&&(r.push(a.value),!n||r.length!==n);t=!0);}catch(u){i=!0,o=u}finally{try{t||null==s.return||s.return()}finally{if(i)throw o}}return r}}(e,n)||(0,t.Z)(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},6257:function(e,n,r){"use strict";r(8483)},6612:function(e,n,r){"use strict";r.d(n,{U:function(){return t}});var t={en:{nav_home:"Home",nav_trophies:"Trophies",user_change_avatar:"Change Avatar",user_login:"Login",user_logout:"Logout"},jp:{nav_home:"\u30db\u30fc\u30e0",nav_trophies:"\u30c8\u30ed\u30d5\u30a3\u30fc",user_change_avatar:"\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u5909\u66f4",user_login:"\u30ed\u30b0\u30a4\u30f3",user_logout:"\u30ed\u30b0\u30a2\u30a6\u30c8"}}},8251:function(e,n,r){"use strict";r.d(n,{S:function(){return h},F:function(){return p}});var t=r(4699),i=r(7922),o=(r(6257),r(7294)),a=r(6716),s=r(5720),u=r(2303),c=r(2334),l=r(2407),f=r(1361),d=r(9127),v=i.Z.firestore(),g={ruby:1,diamond:2,gold:3,silver:4,bronze:5};function h(){var e=(0,o.useMemo)((function(){return new a.x}),[]);return(0,o.useEffect)((function(){var n=new s.w0;return n.add((0,u.Dp)(v.collection("trophies").get()).pipe(l._M).pipe(f.Q).pipe((0,d.U)((function(e){return e.sort((function(e,n){return g[e.color]-g[n.color]}))}))).subscribe(e)),function(){n.unsubscribe()}}),[e]),e}function p(e){var n=h(),r=(0,o.useMemo)((function(){return new a.x}),[]);return(0,o.useEffect)((function(){var i=new s.w0;return i.add((0,c.a)([n,e.pipe((0,d.U)((function(e){return e.finishedTropies||[]})))]).pipe((0,d.U)((function(e){var n=(0,t.Z)(e,2),r=n[0],i=n[1];return i&&0!==i.length?r.filter((function(e){return i.every((function(n){return!e._ref.isEqual(n)}))})):r}))).subscribe(r)),function(){i.unsubscribe()}}),[n,r,e]),r}},5011:function(e,n,r){"use strict";r.d(n,{Z:function(){return b}});var t=r(5893),i=r(1664),o=r(7922),a=(r(3404),r(6690),r(3006)),s=r(7294),u=r(6156),c=r(6503),l=r.n(c),f=r(1389),d=r(3062);function v(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function g(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?v(Object(r),!0).forEach((function(n){(0,u.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var h=o.Z.storage().ref();function p(e){var n=e.shown,r=e.onSave,i=e.onClose,o=(e.language,(0,s.useState)(null)),u=o[0],c=o[1],v=(0,s.useCallback)((function(e){c(e[0])}),[]),p=(0,f.u)({onDrop:v}),x=p.getRootProps,m=p.getInputProps,j=p.isDragActive,b=(0,s.useState)(void 0),y=b[0],_=b[1];(0,s.useEffect)((function(){_(u?URL.createObjectURL(u):void 0)}),[u]);var w=(0,s.useState)(!1),N=w[0],O=w[1],k=(0,s.useState)(!1),D=k[0],S=k[1];(0,s.useEffect)((function(){n?(O(!0),S(!0)):(S(!1),setTimeout((function(){O(!1)}),250))}),[n]);var U=(0,s.useState)(!1),E=U[0],C=U[1],P=(0,d.BF)(),Z=(0,s.useState)(null),A=Z[0],B=Z[1];return(0,s.useEffect)((function(){P.subscribe((function(e){B(e?e.uid:null)}))}),[P]),(0,t.jsx)("div",{className:"overlay-layout",style:{opacity:D?1:0,display:N?"flex":"none",transition:"250ms",justifyContent:"center",alignItems:"center"},children:(0,t.jsxs)("div",{className:l().box,children:[(0,t.jsxs)("div",{className:l().head,children:[(0,t.jsx)("div",{className:l().title,children:"Change Icon"}),(0,t.jsx)("div",{className:l().close,onClick:function(e){c(null),i()},children:(0,t.jsx)(a.aM,{})})]}),(0,t.jsx)("div",{className:l().content,children:(0,t.jsxs)("div",g(g({},x()),{},{className:l().imageDrag+" "+(j?l().dragging:""),children:[(0,t.jsx)("input",g({},m())),j?(0,t.jsx)("div",{children:"Drop the files here..."}):y?(0,t.jsx)("div",{className:"w-full h-full rounded-full",style:{background:"url(".concat(y,") 0% 0% / cover")}}):(0,t.jsx)("div",{children:"Drag and drop some files here, or click to select files."}),E?(0,t.jsx)("div",{className:l()["loading-overlay"],children:(0,t.jsx)("div",{className:l().icon,children:(0,t.jsx)(a.Ho,{})})}):null]}))}),(0,t.jsxs)("div",{className:l().foot,children:[(0,t.jsx)("div",{className:l().primary,children:(0,t.jsx)("button",{disabled:!u||E,onClick:function(e){C(!0),h.child("UserAvatar/"+A).put(u).then((function(){C(!1),c(null),r()})).catch((function(e){C(!1)}))},children:"Save"})}),(0,t.jsx)("div",{className:l().secondary})]})]})})}var x=r(6612),m=o.Z.storage().ref();function j(e){var n=e.link,r=e.icon,o=e.title;return(0,t.jsx)("div",{className:"item",children:(0,t.jsx)(i.default,{href:n||"",children:(0,t.jsxs)("a",{children:[r||null,(0,t.jsx)("span",{children:o})]})})})}function b(e){var n=e.language,r=(0,d.NF)(),i=r.userLoaded,u=r.user,c=(0,s.useState)(!1),l=c[0],f=c[1],v=(0,s.useCallback)((function(){f((function(e){return!e}))}),[]),g=(0,s.useState)(!1),h=g[0],b=g[1],y=(0,s.useState)(null),_=y[0],w=y[1];(0,s.useEffect)((function(){w(null),u&&m.child("UserAvatar/"+u.uid).getDownloadURL().catch((function(e){return m.child("UserAvatar/default_male.png").getDownloadURL()})).then((function(e){w(e)}))}),[u,l]);var N=(0,s.useMemo)((function(){return x.U[n]}),[n]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("nav",{className:"homeNav",children:(0,t.jsxs)("div",{className:"session",children:[(0,t.jsx)(j,{title:N.nav_home,icon:(0,t.jsx)(a.tv,{}),link:"/"}),(0,t.jsx)(j,{title:N.nav_trophies,icon:(0,t.jsx)(a.KW,{}),link:"/trophies"}),(0,t.jsx)("div",{className:"item",style:{paddingTop:"1.5rem",paddingBottom:"1.5rem"},children:!i||u&&!_?(0,t.jsx)("div",{className:"group relative flex items-center",children:(0,t.jsx)("div",{className:"w-16 h-16 rounded-full",children:(0,t.jsx)(a.Ho,{style:{width:"100%"}})})}):u?(0,t.jsxs)("div",{className:"group relative flex items-center",children:[(0,t.jsx)("div",{style:{backgroundImage:"url(".concat(_,")"),backgroundColor:"rgba(var(--color-text-rgb), 0.25)",backgroundSize:"cover"},className:"w-12 h-12 rounded-full"}),(0,t.jsxs)("div",{style:{top:"100%",right:-10,marginTop:-10,background:"#fff",whiteSpace:"nowrap"},className:"group-hover:block absolute shadow-xl rounded-2xl hidden text-center",children:[(0,t.jsx)("div",{className:"px-8 py-3 hover:bg-gray-100 active:bg-gray-200 rounded-t-2xl",onClick:function(e){b(!0)},children:N.user_change_avatar}),(0,t.jsx)("div",{className:"px-8 py-3 hover:bg-gray-100 active:bg-gray-200 rounded-b-2xl",onClick:function(e){o.Z.auth().signOut()},children:N.user_logout})]})]}):(0,t.jsx)(j,{title:N.user_login,link:"/login"})})]})}),(0,t.jsx)("div",{className:"overlay-container",children:(0,t.jsx)(p,{shown:h,onSave:function(){b(!1),v()},onClose:function(){b(!1)},language:n})})]})}},7307:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return u}});var t=r(5893),i=r(9008),o=r(5011),a=r(8251),s=r(7294);function u(e){var n=(0,a.S)(),r=(0,s.useState)([]),u=(r[0],r[1]);return(0,s.useEffect)((function(){n.subscribe((function(e){u(e)}))}),[n]),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"home-container",children:[(0,t.jsx)(i.default,{children:(0,t.jsx)("title",{children:"Trophies"})}),(0,t.jsx)(o.Z,{language:e.language}),(0,t.jsx)("div",{className:"tropies-container session",children:(0,t.jsxs)("div",{className:"tropies",children:["\u958b\u767a\u9014\u4e2d\u3067\u3059\uff01\u3082\u3046\u3057\u3070\u3089\u304f\u304a\u5f85\u3061\u304f\u3060\u3055\u3044\uff01",(0,t.jsx)("br",{}),"Development in progress. Please wait for a while."]})})]})})}},3446:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/trophies",function(){return r(7307)}])},6503:function(e){e.exports={box:"DialogBox_box__S_UC-",head:"DialogBox_head__1NaSO",foot:"DialogBox_foot__FU4gZ",content:"DialogBox_content__3pSSD",title:"DialogBox_title__2uUJU",close:"DialogBox_close__1VdlZ",imageDrag:"DialogBox_imageDrag__UuMVk","loading-overlay":"DialogBox_loading-overlay__1TVoX",icon:"DialogBox_icon__1fEww",dragging:"DialogBox_dragging__21nYg"}},2334:function(e,n,r){"use strict";r.d(n,{a:function(){return h}});var t=r(1480),i=Array.isArray,o=Object.getPrototypeOf,a=Object.prototype,s=Object.keys;function u(e){if(1===e.length){var n=e[0];if(i(n))return{args:n,keys:null};if((t=n)&&"object"===typeof t&&o(t)===a){var r=s(n);return{args:r.map((function(e){return n[e]})),keys:r}}}var t;return{args:e,keys:null}}var c=r(2303),l=r(278),f=r(3211),d=r(7617);function v(e,n){return e.reduce((function(e,r,t){return e[r]=n[t],e}),{})}var g=r(2566);function h(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(0,d.yG)(e),i=(0,d.jO)(e),o=u(e),a=o.args,s=o.keys;if(0===a.length)return(0,c.Dp)([],r);var g=new t.y(p(a,r,s?function(e){return v(s,e)}:l.y));return i?g.pipe((0,f.Z)(i)):g}function p(e,n,r){return void 0===r&&(r=l.y),function(t){x(n,(function(){for(var i=e.length,o=new Array(i),a=i,s=i,u=function(i){x(n,(function(){var u=(0,c.Dp)(e[i],n),l=!1;u.subscribe(new g.Q(t,(function(e){o[i]=e,l||(l=!0,s--),s||t.next(r(o.slice()))}),(function(){--a||t.complete()})))}),t)},l=0;l<i;l++)u(l)}),t)}}function x(e,n,r){e?r.add(e.schedule(n)):n()}},7617:function(e,n,r){"use strict";r.d(n,{_6:function(){return s},jO:function(){return o},yG:function(){return a}});var t=r(8474);function i(e){return e[e.length-1]}function o(e){return(0,t.m)(i(e))?e.pop():void 0}function a(e){return(n=i(e))&&(0,t.m)(n.schedule)?e.pop():void 0;var n}function s(e,n){return"number"===typeof i(e)?e.pop():n}},3211:function(e,n,r){"use strict";r.d(n,{Z:function(){return a}});var t=r(5987),i=r(9127),o=Array.isArray;function a(e){return(0,i.U)((function(n){return function(e,n){return o(n)?e.apply(void 0,(0,t.ev)([],(0,t.CR)(n))):e(n)}(e,n)}))}}},function(e){e.O(0,[774,828,834,724,503,944,173,457,389,839,888,179],(function(){return n=3446,e(e.s=n);var n}));var n=e.O();_N_E=n}]);